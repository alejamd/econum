<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Journal</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MyLabJournal</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Journal.html">Journal</a>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Journal</h1>

</div>


<div id="explorando-bases-de-dados" class="section level2">
<h2>1. Explorando bases de dados</h2>
<p>Criando uma matriz de presência e ausência de espécies, com 20 espécies e 8 localidades.</p>
<pre class="r"><code>set.seed(999) 
tibble(
  spec = paste0(&quot;sp&quot;, 1:20),
  siteA = sample(c(0:1), replace=TRUE, size=20),
  siteB = sample(c(0:1), replace=TRUE, size=20),
  siteC = sample(c(0:1), replace=TRUE, size=20),
  siteD = sample(c(0:1), replace=TRUE, size=20),
  siteE = sample(c(0:1), replace=TRUE, size=20),
  siteF = sample(c(0:1), replace=TRUE, size=20),
  siteG = sample(c(0:1), replace=TRUE, size=20),
  siteH = sample(c(0:1), replace=TRUE, size=20) 
)-&gt;matpresaus

print.data.frame(matpresaus)</code></pre>
<pre><code>##    spec siteA siteB siteC siteD siteE siteF siteG siteH
## 1   sp1     0     1     1     0     0     0     0     0
## 2   sp2     1     0     0     1     1     1     0     1
## 3   sp3     0     0     0     0     0     0     1     0
## 4   sp4     0     0     1     0     0     1     1     0
## 5   sp5     0     1     0     0     1     0     1     0
## 6   sp6     1     1     0     1     0     1     1     1
## 7   sp7     0     0     0     0     0     1     1     0
## 8   sp8     1     0     1     1     0     1     1     0
## 9   sp9     1     0     1     1     0     0     0     0
## 10 sp10     1     0     1     0     0     1     0     1
## 11 sp11     0     0     1     1     1     1     1     1
## 12 sp12     0     0     1     0     0     1     1     0
## 13 sp13     1     1     1     1     1     0     0     1
## 14 sp14     0     1     1     0     0     0     0     1
## 15 sp15     0     1     0     0     0     0     1     1
## 16 sp16     0     1     0     1     1     1     1     1
## 17 sp17     1     0     1     0     1     1     0     0
## 18 sp18     1     0     0     0     0     0     1     0
## 19 sp19     0     0     0     1     0     0     1     0
## 20 sp20     0     0     1     0     0     0     0     1</code></pre>
<p>Agora uma matriz de abundância, com 30 espécies, 10 localidades, e abundâncias entre 0-20 nas localidades A-E, e 0-50 nas localidades F-J.</p>
<pre class="r"><code>set.seed(999)
tibble(
  spec = paste0(&quot;sp&quot;, 1:30),
  siteA = sample(c(0:20), replace=TRUE, size=30),
  siteB = sample(c(0:20), replace=TRUE, size=30),
  siteC = sample(c(0:20), replace=TRUE, size=30),
  siteD = sample(c(0:20), replace=TRUE, size=30),
  siteE = sample(c(0:20), replace=TRUE, size=30),
  siteF = sample(c(0:50), replace=TRUE, size=30),
  siteG = sample(c(0:50), replace=TRUE, size=30),
  siteH = sample(c(0:50), replace=TRUE, size=30),
  siteI = sample(c(0:50), replace=TRUE, size=30),
  siteJ = sample(c(0:50), replace=TRUE, size=30)
)-&gt;base1
print.data.frame(base1)</code></pre>
<pre><code>##    spec siteA siteB siteC siteD siteE siteF siteG siteH siteI siteJ
## 1   sp1     3     3     1    10    14    31    16    14    50    13
## 2   sp2     6     3     5     9     9     5    39    36     6    17
## 3   sp3     8     8    14    10    19    35     8    32     2    47
## 4   sp4    13     6    20    16    18    48    25    46    44     4
## 5   sp5     0     1     0    11     4    14    34    10    39    15
## 6   sp6     9    12    12     8    10     3    39    21    42    13
## 7   sp7     2     1     3     0    13    41    22    24     9    15
## 8   sp8    14    12    13    10    11    39    12    29    39    10
## 9   sp9     4     6    17    17    11    41    17     6    21    39
## 10 sp10     6     1    14     5    18    13    34    27    28    34
## 11 sp11     5    12    15    18     8     1    16    29    41    30
## 12 sp12    18    11     2     8     3    29    37    33    49    41
## 13 sp13    10    12     0    20     9    24     8    14    30    33
## 14 sp14    17    11    20    17     9    12     7    30    48    41
## 15 sp15     0     1    12    19     5    37    25    44    45     7
## 16 sp16     4    16    14    15    13    32    20     7     4    23
## 17 sp17    18    11    20     2    18    40    36    26    20    18
## 18 sp18    11    18    12    17     8    17    31    21    50    43
## 19 sp19     8    19     2     1     9    34    48    26    22    23
## 20 sp20    20     6     3     0    17    47     9    42     6    37
## 21 sp21     4     8     7     7     3    18    17    50    35    16
## 22 sp22     3     3    15    20     5    18    48    33    35    48
## 23 sp23    14     8    13     5     5     0    27    36    35    25
## 24 sp24    15    19    13     4    17    19    23    15    21    22
## 25 sp25    10     6    15    18     3    49    49    20     2    43
## 26 sp26     1     0    11     5     9    12    10    10    42    46
## 27 sp27     8     4     9     8    19    15    33     6     5    34
## 28 sp28     0     1    10    15    17    34    45    48    25     8
## 29 sp29    17     7    13     3    16     6     9    25     2    24
## 30 sp30     7    18    10    11    17     9    21    35     2    42</code></pre>
<p><strong>Nota</strong>: Estou utilizando a função print.data.frame, pois o tibble sozinho mostra a tabela numa janela separada, e a tabela aparece incompleta no knit pro html.</p>
<p>Agora criando um sumário da base de dados criada.</p>
<pre class="r"><code>summary(base1)</code></pre>
<pre><code>##      spec               siteA           siteB            siteC     
##  Length:30          Min.   : 0.00   Min.   : 0.000   Min.   : 0.0  
##  Class :character   1st Qu.: 4.00   1st Qu.: 3.000   1st Qu.: 5.5  
##  Mode  :character   Median : 8.00   Median : 7.500   Median :12.0  
##                     Mean   : 8.50   Mean   : 8.133   Mean   :10.5  
##                     3rd Qu.:13.75   3rd Qu.:12.000   3rd Qu.:14.0  
##                     Max.   :20.00   Max.   :19.000   Max.   :20.0  
##      siteD           siteE           siteF           siteG          siteH      
##  Min.   : 0.00   Min.   : 3.00   Min.   : 0.00   Min.   : 7.0   Min.   : 6.00  
##  1st Qu.: 5.00   1st Qu.: 8.00   1st Qu.:12.25   1st Qu.:16.0   1st Qu.:16.25  
##  Median :10.00   Median :10.50   Median :21.50   Median :24.0   Median :26.50  
##  Mean   :10.30   Mean   :11.23   Mean   :24.10   Mean   :25.5   Mean   :26.50  
##  3rd Qu.:16.75   3rd Qu.:17.00   3rd Qu.:36.50   3rd Qu.:35.5   3rd Qu.:34.50  
##  Max.   :20.00   Max.   :19.00   Max.   :49.00   Max.   :49.0   Max.   :50.00  
##      siteI           siteJ      
##  Min.   : 2.00   Min.   : 4.00  
##  1st Qu.: 6.75   1st Qu.:15.25  
##  Median :29.00   Median :24.50  
##  Mean   :26.63   Mean   :27.03  
##  3rd Qu.:41.75   3rd Qu.:40.50  
##  Max.   :50.00   Max.   :48.00</code></pre>
<pre class="r"><code>load(&quot;C:/Users/alexa/OneDrive/Documentos/GitHub/econum/NEwR-2ed_code_data/NEwR2-Data/Doubs.RData&quot;) # Carregando os dados que o livro usa como exemplo

print.data.frame(spe)</code></pre>
<pre><code>##    Cogo Satr Phph Babl Thth Teso Chna Pato Lele Sqce Baba Albi Gogo Eslu Pefl
## 1     0    3    0    0    0    0    0    0    0    0    0    0    0    0    0
## 2     0    5    4    3    0    0    0    0    0    0    0    0    0    0    0
## 3     0    5    5    5    0    0    0    0    0    0    0    0    0    1    0
## 4     0    4    5    5    0    0    0    0    0    1    0    0    1    2    2
## 5     0    2    3    2    0    0    0    0    5    2    0    0    2    4    4
## 6     0    3    4    5    0    0    0    0    1    2    0    0    1    1    1
## 7     0    5    4    5    0    0    0    0    1    1    0    0    0    0    0
## 8     0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
## 9     0    0    1    3    0    0    0    0    0    5    0    0    0    0    0
## 10    0    1    4    4    0    0    0    0    2    2    0    0    1    0    0
## 11    1    3    4    1    1    0    0    0    0    1    0    0    0    0    0
## 12    2    5    4    4    2    0    0    0    0    1    0    0    0    0    0
## 13    2    5    5    2    3    2    0    0    0    0    0    0    0    0    0
## 14    3    5    5    4    4    3    0    0    0    1    1    0    1    1    0
## 15    3    4    4    5    2    4    0    0    3    3    2    0    2    0    0
## 16    2    3    3    5    0    5    0    4    5    2    2    1    2    1    1
## 17    1    2    4    4    1    2    1    4    3    2    3    4    1    1    2
## 18    1    1    3    3    1    1    1    3    2    3    3    3    2    1    3
## 19    0    0    3    5    0    1    2    3    2    1    2    2    4    1    1
## 20    0    0    1    2    0    0    2    2    2    3    4    3    4    2    2
## 21    0    0    1    1    0    0    2    2    2    2    4    2    5    3    3
## 22    0    0    0    1    0    0    3    2    3    4    5    1    5    3    4
## 23    0    0    0    0    0    0    0    0    0    1    0    0    0    0    0
## 24    0    0    0    0    0    0    1    0    0    2    0    0    1    0    0
## 25    0    0    0    0    0    0    0    0    1    1    0    0    2    1    0
## 26    0    0    0    1    0    0    1    0    1    2    2    1    3    2    1
## 27    0    0    0    1    0    0    1    1    2    3    4    1    4    4    1
## 28    0    0    0    1    0    0    1    1    2    4    3    1    4    3    2
## 29    0    1    1    1    1    1    2    2    3    4    5    3    5    5    4
## 30    0    0    0    0    0    0    1    2    3    3    3    5    5    4    5
##    Rham Legi Scer Cyca Titi Abbr Icme Gyce Ruru Blbj Alal Anan
## 1     0    0    0    0    0    0    0    0    0    0    0    0
## 2     0    0    0    0    0    0    0    0    0    0    0    0
## 3     0    0    0    0    0    0    0    0    0    0    0    0
## 4     0    0    0    0    1    0    0    0    0    0    0    0
## 5     0    0    2    0    3    0    0    0    5    0    0    0
## 6     0    0    0    0    2    0    0    0    1    0    0    0
## 7     0    0    0    0    0    0    0    0    0    0    0    0
## 8     0    0    0    0    0    0    0    0    0    0    0    0
## 9     0    0    0    0    1    0    0    0    4    0    0    0
## 10    0    0    0    0    0    0    0    0    0    0    0    0
## 11    0    0    0    0    0    0    0    0    0    0    0    0
## 12    0    0    0    0    0    0    0    0    0    0    0    0
## 13    0    0    0    0    0    0    0    0    0    0    0    0
## 14    0    0    0    0    0    0    0    0    0    0    0    0
## 15    0    0    0    0    1    0    0    0    0    0    0    0
## 16    0    1    0    1    1    0    0    0    1    0    0    0
## 17    1    1    0    1    1    0    0    0    2    0    2    1
## 18    2    1    0    1    1    0    0    1    2    0    2    1
## 19    2    1    1    1    2    1    0    1    5    1    3    1
## 20    3    2    2    1    4    1    0    2    5    2    5    2
## 21    3    2    2    2    4    3    1    3    5    3    5    2
## 22    3    3    2    3    4    4    2    4    5    4    5    2
## 23    0    0    0    0    0    0    0    0    1    0    2    0
## 24    0    1    0    0    0    0    0    2    2    1    5    0
## 25    0    0    1    0    0    0    0    1    1    0    3    0
## 26    2    2    1    1    3    2    1    4    4    2    5    2
## 27    3    3    1    2    5    3    2    5    5    4    5    3
## 28    4    4    2    4    4    3    3    5    5    5    5    4
## 29    5    5    2    3    3    4    4    5    5    4    5    4
## 30    5    3    5    5    5    5    5    5    5    5    5    5</code></pre>
<pre class="r"><code>range(spe)</code></pre>
<pre><code>## [1] 0 5</code></pre>
<pre class="r"><code>apply(spe, 2, range)</code></pre>
<pre><code>##      Cogo Satr Phph Babl Thth Teso Chna Pato Lele Sqce Baba Albi Gogo Eslu Pefl
## [1,]    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0
## [2,]    3    5    5    5    4    5    3    4    5    5    5    5    5    5    5
##      Rham Legi Scer Cyca Titi Abbr Icme Gyce Ruru Blbj Alal Anan
## [1,]    0    0    0    0    0    0    0    0    0    0    0    0
## [2,]    5    5    5    5    5    5    5    5    5    5    5    5</code></pre>
<pre class="r"><code>(ab &lt;- table(unlist(spe)))</code></pre>
<pre><code>## 
##   0   1   2   3   4   5 
## 435 108  87  62  54  64</code></pre>
<pre class="r"><code>barplot(ab, 
  las = 1,
  xlab = &quot;Classe de abundância&quot;,
  ylab = &quot;Frequência&quot;,
  col = rainbow(6:1)
)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>sum(spe == 0)</code></pre>
<pre><code>## [1] 435</code></pre>
<pre class="r"><code>sum(spe == 0) / (nrow(spe) * ncol(spe))</code></pre>
<pre><code>## [1] 0.537037</code></pre>
<p><strong>Respondendo algumas perguntas</strong> Onde há mais espécies de peixes? Existe uma tendência de riqueza em relação à direção do rio?</p>
<pre class="r"><code>plot(spa, 
  asp = 1, 
  type = &quot;n&quot;, 
  main = &quot;N de espécies nos locais amostrados&quot;, 
  xlab = &quot;x coordinate (km)&quot;, 
  ylab = &quot;y coordinate (km)&quot;
)
lines(spa, col = &quot;light blue&quot;)
text(spa, row.names(spa), cex = 1, col = &quot;blue&quot;)
text(68, 20, &quot;Nascente&quot;, cex = 1.2, col = &quot;blue&quot;)
text(15, 35, &quot;Foz&quot;, cex = 1.2, col = &quot;blue&quot;)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>É observado que a maior riqueza está ba foz. Sim, existe uma tendência clara na riqueza: existem mais espécies quanto mais perto da foz. Isso pode ser porque, na maioria dos rios, os estuários também possuem uma grande abundância de espécies marinhas, muitas mais até do que as espécies de água doce. Algumas espécies marinhas também podem ir rio acima em certas fases ontogenéticas, como em estágios larvais e na reprodução.</p>
<p>Mas e quanto à abundância? se distribui da mesma forma?</p>
<pre class="r"><code> plot(env$dfs, 
  spe$Satr, 
  type = &quot;l&quot;, 
  col = 4, 
  main = &quot;Abundância&quot;,
  xlab = &quot;Distância da nascente [km]&quot;, 
  ylab = &quot;Abundância &#39;crua&#39; (contagem simples) &quot;
)
lines(env$dfs, spe$Thth, col = 3)
lines(env$dfs, spe$Baba, col = &quot;orange&quot;)
lines(env$dfs, spe$Abbr, col = 2)
lines(env$dfs, spe$Babl, col = 1, lty = &quot;dotted&quot;)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>É observado que a abundância não necessariamente possui o mesmo padrão de distribuição ao longo do rio em relação à riqueza, que está concentrada na foz. Algumas espécies são mais abundantes na nascente, outras na pate média do rio, outras na foz.</p>
<p>Claramente existem outras variáveis ambientais além da distância da nascente influenciando a abundância das espécies. Quais variáveis ambientais podem explicar isso?</p>
<pre class="r"><code>plot(spa, 
  asp = 1, 
  cex.axis = 0.8, 
  main = &quot;Elevação&quot;, 
  pch = 21, 
  col = &quot;white&quot;, 
  bg = &quot;red&quot;, 
  cex = 5 * env$ele / max(env$ele), 
  xlab = &quot;x&quot;, 
  ylab = &quot;y&quot;
)
lines(spa, col = &quot;light blue&quot;)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>plot(spa, 
  asp = 1, 
  cex.axis = 0.8, 
  main = &quot;Descarga&quot;, 
  pch = 21, 
  col = &quot;white&quot;, 
  bg = &quot;blue&quot;,
  cex = 5 * env$dis / max(env$dis),
  xlab = &quot;x&quot;, 
  ylab = &quot;y&quot;
)
lines(spa, col = &quot;light blue&quot;)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre class="r"><code>plot(spa, 
  asp = 1, 
  cex.axis = 0.8, 
  main = &quot;Oxigênio&quot;, 
  pch = 21, 
  col = &quot;white&quot;, 
  bg = &quot;green3&quot;,
  cex = 5 * env$oxy / max(env$oxy),
  xlab =  &quot;x&quot;, 
  ylab = &quot;y&quot;
)
lines(spa, col = &quot;light blue&quot;)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<pre class="r"><code>plot(spa, 
  asp = 1,
  cex.axis = 0.8, 
  main = &quot;Nitrato&quot;, 
  pch = 21,
  col = &quot;white&quot;, 
  bg = &quot;brown&quot;,
  cex = 5 * env$nit / max(env$nit),
  xlab = &quot;x&quot;, 
  ylab = &quot;y&quot;
)
lines(spa, col = &quot;light blue&quot;)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-8-4.png" width="672" /></p>
<p>O rio possui mais elevação perto da nascente, e mais descarga perto da foz, o que é comum para um rio. Esses podem ser fatores que influenciam tanto na riqueza quanto na abundância das espécies que ocorrem mais próximas à nascente e à foz, pois podem afetar fatores como o fluxo de nutrientes na água. Além disso, esse grau de elevação e descarga também indica que larvas planctônicas de espécies que desovam na nascente podem ir parar na foz, concedendo uma maior riqueza.</p>
<p>O rio possui mais oxigênio na nascente e na parte média, e possui mais nitrato na parte média-baixa. As espécies que são abundantes no médio e médio-alto rio provavelmente favoerecem águas com mais oxigênio, enquanto espécies do médio e médio-baixo rio favorecem águas com mais nitrato.</p>
<p><strong>Nota</strong>: Aparentemente o rmarkdown tem algum problema com a função dev.new e não plota os gráficos quando faço knit pra html, então plotei os gráficos das variáveis ambientais separados.</p>
</div>
<div id="medidas-de-associação" class="section level2">
<h2>2. Medidas de associação</h2>
<p>Utilizando a base de dados os peixes da Suíça:</p>
<pre class="r"><code># Removendo as localidades vazias
spe &lt;- spe[-8, ]
env &lt;- env[-8, ]
spa &lt;- spa[-8, ]

# Aplicado as medidas de dissimilaridade
library(vegan)
spe.db &lt;- vegdist(spe) # método de bray
spe.dbln &lt;- vegdist(log1p(spe)) # abundâncias logaritmizadas
spe.norm &lt;- decostand(spe, &quot;nor&quot;)
spe.dc &lt;- dist(spe.norm) # matriz de chord distance
spe.hel &lt;- decostand(spe, &quot;hel&quot;)
spe.dh &lt;- dist(spe.hel) # matriz de distância de hellinger
head(spe.db)</code></pre>
<pre><code>## [1] 0.6000000 0.6842105 0.7500000 0.8918919 0.7500000 0.6842105</code></pre>
<pre class="r"><code>head(spe.dbln)</code></pre>
<pre><code>## [1] 0.5509095 0.6280761 0.7446012 0.8664653 0.7657643 0.6519273</code></pre>
<pre class="r"><code>head(spe.dc)</code></pre>
<pre><code>## [1] 0.7653669 0.9235374 1.0432236 1.2786132 1.1153793 0.8873116</code></pre>
<pre class="r"><code>head(spe.dh)</code></pre>
<pre><code>## [1] 0.8420247 0.9391305 1.0616631 1.2308244 1.1153793 0.9391305</code></pre>
<p><strong>Nota</strong>: Aparentemente o rmarkdown não acredita de jeito nenhum que a função coldiss existe, então eu tive que catar a definição da função e colocar nesse documento.</p>
<pre class="r"><code># coldiss()
# Color plots of a dissimilarity matrix, without and with ordering
#
# License: GPL-2 
# Author: Francois Gillet, 23 August 2012
#

&quot;coldiss&quot; &lt;- function(D, nc = 4, byrank = TRUE, diag = FALSE)
{
    library(gclus)

    if (max(D)&gt;1) D &lt;- D/max(D)

    if (byrank) {
        spe.color &lt;- dmat.color(1-D, cm.colors(nc))
    }
    else {
        spe.color &lt;- dmat.color(1-D, byrank=FALSE, cm.colors(nc))
    }

    spe.o &lt;- order.single(1-D)
    speo.color &lt;- spe.color[spe.o, spe.o]
    
    op &lt;- par(mfrow=c(1,2), pty=&quot;s&quot;)

    if (diag) {
        plotcolors(spe.color, rlabels=attributes(D)$Labels, 
            main=&quot;Dissimilarity Matrix&quot;, 
            dlabels=attributes(D)$Labels)
        plotcolors(speo.color, rlabels=attributes(D)$Labels[spe.o], 
            main=&quot;Ordered Dissimilarity Matrix&quot;, 
            dlabels=attributes(D)$Labels[spe.o])
    }
    else {
        plotcolors(spe.color, rlabels=attributes(D)$Labels, 
            main=&quot;Dissimilarity Matrix&quot;)
        plotcolors(speo.color, rlabels=attributes(D)$Labels[spe.o], 
            main=&quot;Ordered Dissimilarity Matrix&quot;)
    }

    par(op)
}

# Usage:
# coldiss(D = dissimilarity.matrix, nc = 4, byrank = TRUE, diag = FALSE)
# If D is not a dissimilarity matrix (max(D) &gt; 1), then D is divided by max(D)
# nc                            number of colours (classes)
# byrank= TRUE      equal-sized classes
# byrank= FALSE     equal-length intervals
# diag = TRUE           print object labels also on the diagonal

# Example:
# coldiss(spe.dj, nc=9, byrank=F, diag=T)</code></pre>
<p>Agora, criando as matrizes de dissimilaridade</p>
<pre class="r"><code>coldiss(spe.db, diag = TRUE) #plotando a dissimilaridade de bray</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>coldiss(spe.dbln, diag = TRUE) # plotando as abundâncias logaritmizadas</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>coldiss(spe.dc, diag = TRUE) # plotando a chord distance</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>coldiss(spe.dh, diag = TRUE) # plotando a distância de hellinger </code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p><strong>Pergunta</strong>: A descarga d’água no rio afeta a composição das comunidades de peixes?</p>
<pre class="r"><code>library(vegan)
euc_dist&lt;-vegdist(spe, method = &quot;euclidean&quot;) #medindo a distância euclidiana 
euc_dist</code></pre>
<pre><code>##            1         2         3         4         5         6         7
## 2   5.385165                                                            
## 3   7.416198  2.449490                                                  
## 4   7.874008  4.123106  3.000000                                        
## 5  10.816654 10.677078 10.862780  9.219544                              
## 6   7.348469  4.582576  4.123106  2.828427  8.185353                    
## 7   6.855655  2.449490  2.000000  3.605551 10.488088  3.605551          
## 9   7.810250  8.717798  9.380832  8.774964  9.380832  6.708204  8.485281
## 10  6.708204  5.099020  5.291503  5.000000  9.273618  3.605551  4.472136
## 11  4.472136  3.316625  5.000000  5.477226 10.246951  5.291503  4.795832
## 12  6.708204  3.162278  3.464102  4.582576 11.045361  4.795832  3.162278
## 13  7.071068  4.358899  5.196152  6.164414 11.532563  6.633250  5.385165
## 14  9.110434  6.324555  6.164414  6.557439 11.916375  7.000000  6.324555
## 15  9.899495  7.810250  7.681146  7.483315 10.816654  6.633250  6.855655
## 16 11.090537  9.899495  9.797959  9.327379 10.198039  8.426150  9.055385
## 17 10.630146  9.486833  9.486833  8.774964  9.797959  8.062258  9.055385
## 18  9.848858  9.591663  9.899495  8.660254  9.055385  7.810250  9.380832
## 19 11.704700 11.135529 11.045361 10.148892  9.380832  8.888194 10.770330
## 20 13.453624 14.212670 14.628739 13.453624 10.770330 12.206556 14.212670
## 21 14.456832 15.362291 15.811388 14.525839 11.489125 13.601471 15.556349
## 22 16.643317 17.663522 18.110770 16.763055 13.416408 15.779734 17.663522
## 23  3.872983  7.483315  9.055385  9.000000 10.583005  7.937254  8.485281
## 24  7.071068  9.539392 10.816654 10.583005 11.357817  9.486833 10.246951
## 25  5.291503  8.306624  9.643651  9.273618  9.746794  8.246211  9.110434
## 26 11.135529 12.609520 13.304135 12.409674 10.723805 11.224972 12.922848
## 27 15.362291 16.462078 16.881943 15.811388 13.076697 14.696938 16.583124
## 28 16.522712 17.549929 18.000000 16.941074 14.352700 15.905974 17.606817
## 29 18.761663 19.364917 19.621417 18.384776 15.524175 17.776389 19.364917
## 30 20.396078 21.377558 21.794495 20.542639 17.117243 19.849433 21.517435
##            9        10        11        12        13        14        15
## 2                                                                       
## 3                                                                       
## 4                                                                       
## 5                                                                       
## 6                                                                       
## 7                                                                       
## 9                                                                       
## 10  6.480741                                                            
## 11  7.549834  4.582576                                                  
## 12  8.717798  5.477226  3.872983                                        
## 13 10.049876  6.855655  4.000000  3.316625                              
## 14 10.583005  7.615773  6.244998  4.242641  3.316625                    
## 15  9.746794  6.855655  7.745967  6.403124  6.633250  5.000000          
## 16 10.862780  8.485281 10.049876  9.591663  9.746794  8.944272  5.916080
## 17  9.899495  8.246211  9.219544  9.273618  9.643651  9.380832  8.185353
## 18  8.602325  7.874008  8.774964  9.380832  9.949874  9.797959  8.660254
## 19  9.486833  9.273618 11.000000 11.313708 12.041595 11.832160 10.630146
## 20 11.489125 12.727922 13.527749 14.422205 15.000000 14.966630 13.674794
## 21 13.266499 14.142136 14.662878 15.684387 16.031220 16.062378 15.066519
## 22 15.033296 16.248077 16.941074 17.832555 18.303005 18.165902 16.763055
## 23  6.324555  6.633250  5.744563  8.366600  8.774964 10.392305 10.630146
## 24  7.549834  8.544004  8.124038 10.148892 10.583005 11.789826 11.747340
## 25  7.280110  7.000000  6.782330  9.110434  9.486833 10.723805 10.583005
## 26 10.148892 11.445523 11.747340 13.000000 13.490738 13.892444 13.190906
## 27 13.892444 15.264338 15.748016 16.703293 17.146428 17.117243 16.062378
## 28 14.899664 16.309506 16.822604 17.720045 18.193405 18.220867 17.175564
## 29 17.521415 18.303005 18.761663 19.416488 19.646883 19.313208 18.330303
## 30 19.467922 20.371549 20.736441 21.610183 21.863211 21.931712 21.023796
##           16        17        18        19        20        21        22
## 2                                                                       
## 3                                                                       
## 4                                                                       
## 5                                                                       
## 6                                                                       
## 7                                                                       
## 9                                                                       
## 10                                                                      
## 11                                                                      
## 12                                                                      
## 13                                                                      
## 14                                                                      
## 15                                                                      
## 16                                                                      
## 17  6.164414                                                            
## 18  7.615773  3.464102                                                  
## 19  9.165151  6.633250  6.000000                                        
## 20 12.649111  9.380832  7.615773  6.324555                              
## 21 13.928388 11.224972  9.380832  7.874008  3.741657                    
## 22 15.556349 13.416408 11.489125 10.583005  6.480741  4.000000          
## 23 11.489125 10.295630  9.055385 10.488088 11.916375 13.114877 15.362291
## 24 12.449900 10.723805  9.110434  9.746794 10.148892 11.269428 13.304135
## 25 11.180340 10.148892  8.660254  9.539392 10.630146 11.618950 13.964240
## 26 13.076697 10.816654  8.774964  7.810250  5.385165  5.385165  7.549834
## 27 15.329710 13.304135 11.532563 10.246951  6.244998  4.582576  5.000000
## 28 16.370706 14.352700 12.489996 11.489125  7.745967  6.000000  5.099020
## 29 17.058722 14.662878 13.076697 12.767145  9.000000  7.000000  5.567764
## 30 19.621417 17.117243 15.652476 15.000000 11.180340  9.000000  8.185353
##           23        24        25        26        27        28        29
## 2                                                                       
## 3                                                                       
## 4                                                                       
## 5                                                                       
## 6                                                                       
## 7                                                                       
## 9                                                                       
## 10                                                                      
## 11                                                                      
## 12                                                                      
## 13                                                                      
## 14                                                                      
## 15                                                                      
## 16                                                                      
## 17                                                                      
## 18                                                                      
## 19                                                                      
## 20                                                                      
## 21                                                                      
## 22                                                                      
## 23                                                                      
## 24  4.358899                                                            
## 25  3.000000  3.741657                                                  
## 26  9.433981  7.071068  8.000000                                        
## 27 14.035669 11.916375 12.649111  5.291503                              
## 28 15.231546 13.076697 13.964240  7.000000  3.872983                    
## 29 17.804494 15.874508 16.431677  9.899495  6.633250  5.567764          
## 30 19.416488 17.832555 18.055470 11.916375  9.165151  7.280110  6.480741</code></pre>
<pre class="r"><code>library(usedist)
mean(dist_subset(euc_dist, c(1:10))) #calculando a similaridade média dos locais onde a descagar d&#39;água (dfs, de acordo com os dados em env) é &lt;100.</code></pre>
<pre><code>## [1] 6.307065</code></pre>
<pre class="r"><code>mean(dist_subset(euc_dist, c(11:20))) #similaridade média dos locais onde dfs é &gt;100 e &lt;250</code></pre>
<pre><code>## [1] 9.450489</code></pre>
<pre class="r"><code>mean(dist_subset(euc_dist, c(21:29))) #similaridade média dos locais onde dfs é &gt;250</code></pre>
<pre><code>## [1] 10.25096</code></pre>
<pre class="r"><code>clust_rio_euc&lt;-hclust(euc_dist, method = &quot;complete&quot;) #plotando o dendograma
clust_graf_euc&lt;-plot(clust_rio_euc, hang=-1)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code>library(dendextend)
clust_rio_euc2&lt;-as.dendrogram(clust_rio_euc) # transformando o cluster num objeto para poder editar
colors&lt;-c(&quot;#E69F00&quot;, &quot;#E69F00&quot;, &quot;#E69F00&quot;, &quot;#E69F00&quot;, &quot;#E69F00&quot;, &quot;#E69F00&quot;, &quot;#E69F00&quot;, &quot;#E69F00&quot;, &quot;#E69F00&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;, &quot;#56B4E9&quot;, &quot;#56B4E9&quot;, &quot;#56B4E9&quot;, &quot;#56B4E9&quot;, &quot;#56B4E9&quot;, &quot;#56B4E9&quot;, &quot;#56B4E9&quot;, &quot;#56B4E9&quot;, &quot;#56B4E9&quot;, &quot;#009E73&quot;, &quot;#009E73&quot;, &quot;#009E73&quot;, &quot;#009E73&quot;, &quot;#009E73&quot;, &quot;#009E73&quot;, &quot;#009E73&quot;, &quot;#009E73&quot;, &quot;#009E73&quot;) # definindo as cores que serão usadas
colorCode&lt;-c(alto=colors[1:10], medio=colors[11:20], baixo=colors[21:29])
labels_colors(clust_rio_euc2) &lt;- colorCode[order.dendrogram(clust_rio_euc2)]
plot(clust_rio_euc2, main =&quot;foi punk pra conseguir colorir&quot;)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-20-1.png" width="672" /> Pela média das similaridades e pelo dendograma vemos que, possivelmente, maior descarga d’água contribui para uma maior similaridade entre os locais. Utilizando a distância euclidiana, foi obsevado que os locais com dfs&gt;250 apresentaram mais similaridade, e os com dfs&lt;100 apresentaram menos similaridade. Também é possível observar nos clusters do dendograma que, apesar dos locais geograficamente próximos serem mais similares, existem outliers, como os locais 10, 9 e 5.</p>
<p>Isso pode ser dar pois as larvas planctônicas desses peixes são levadas na corrente d’água. Talvez os locais com mais descarga sejam mais similares entre si por conta disso: a corrente numa descarga mais forte é mais propensa a levar peixes de uma comunidade para outra, misturando as comunidades em locais com mais descarga e isolando as comunidades em locais com menos descarga.</p>
</div>
<div id="análise-de-cluster" class="section level2">
<h2>Análise de Cluster</h2>
<p>Já como no útilmo exercício foi medida a distância pra spe, aqui vou utilizar o dendograma já feito pra ver os grupos.</p>
<p>Só olhando, acho que vejo 5 grupos claros, divididos em 2 grandes grupos. Então vou tentar k=5.</p>
<pre class="r"><code>grup_rio&lt;-cutree(clust_rio_euc, k=5) # olhando pro dendograma, acredito que dá pra divir em 5 grupos
table(grup_rio) </code></pre>
<pre><code>## grup_rio
##  1  2  3  4  5 
##  5 11  5  6  2</code></pre>
<pre class="r"><code>plot(clust_rio_euc)
rect.hclust(clust_rio_euc, k = 5, border = 2:5)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code>k5&lt;-kmeans(spe, centers = 5, nstart=1)
k5 # Aqui dá pra ver muita coisa, inclusive a qual cluster (1,2 uo 3) cada amostra do rio pertence. Dá pra ver a média de cada variável entre os clusters </code></pre>
<pre><code>## K-means clustering with 5 clusters of sizes 2, 11, 5, 6, 5
## 
## Cluster means:
##   Cogo     Satr      Phph     Babl     Thth      Teso     Chna     Pato
## 1  0.0 0.500000 0.5000000 0.500000 0.500000 0.5000000 1.500000 2.000000
## 2  1.0 4.090909 4.3636364 3.909091 1.090909 0.8181818 0.000000 0.000000
## 3  0.0 0.600000 0.2000000 0.600000 0.000000 0.0000000 0.200000 0.000000
## 4  0.0 0.000000 0.3333333 1.166667 0.000000 0.0000000 1.666667 1.333333
## 5  0.8 1.600000 3.2000000 3.800000 0.400000 1.8000000 0.800000 2.800000
##        Lele     Sqce      Baba Albi      Gogo      Eslu      Pefl Rham     Legi
## 1 3.0000000 3.500000 4.0000000  4.0 5.0000000 4.5000000 4.5000000    5 4.000000
## 2 0.6363636 1.090909 0.2727273  0.0 0.5454545 0.4545455 0.2727273    0 0.000000
## 3 0.2000000 1.800000 0.0000000  0.0 0.6000000 0.2000000 0.0000000    0 0.200000
## 4 2.0000000 3.000000 3.6666667  1.5 4.1666667 2.8333333 2.1666667    3 2.666667
## 5 3.4000000 2.000000 2.0000000  2.0 2.2000000 1.6000000 2.2000000    1 0.800000
##       Scer     Cyca      Titi     Abbr Icme     Gyce       Ruru     Blbj Alal
## 1 3.500000 4.000000 4.0000000 4.500000  4.5 5.000000 5.00000000 4.500000  5.0
## 2 0.000000 0.000000 0.3636364 0.000000  0.0 0.000000 0.09090909 0.000000  0.0
## 3 0.200000 0.000000 0.2000000 0.000000  0.0 0.600000 1.60000000 0.200000  2.0
## 4 1.666667 2.166667 4.0000000 2.666667  1.5 3.833333 4.83333333 3.333333  5.0
## 5 0.600000 0.800000 1.6000000 0.200000  0.0 0.400000 3.00000000 0.200000  1.4
##   Anan
## 1  4.5
## 2  0.0
## 3  0.0
## 4  2.5
## 5  0.6
## 
## Clustering vector:
##  1  2  3  4  5  6  7  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 
##  3  2  2  2  5  2  2  3  2  2  2  2  2  2  5  5  5  5  4  4  4  3  3  3  4  4 
## 28 29 30 
##  4  1  1 
## 
## Within cluster sum of squares by cluster:
## [1]  21.0000 139.6364  69.2000  81.0000 128.4000
##  (between_SS / total_SS =  77.3 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
## [6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;</code></pre>
<p>Os 5 clusters, divididos bem do jeito que eu imaginaria que seriam.</p>
<pre class="r"><code>library(factoextra)
fviz_cluster(k5, data = spe)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-24-1.png" width="672" /> Agora vou testar o número estatisticamente ideal de clusters.</p>
<pre class="r"><code>fviz_nbclust(spe, kmeans, method = &quot;silhouette&quot;)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-25-1.png" width="672" /> Parece que na verdade são dois. Agora vou re-fazer o plot de distância com k=2.</p>
<pre class="r"><code>k2&lt;-kmeans(spe, centers =2, nstart=1)
fviz_cluster(k2, data = spe)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-26-1.png" width="672" /> Agora observando isso no dendograma:</p>
<pre class="r"><code>plot(clust_rio_euc)
rect.hclust(clust_rio_euc, k = 2, border = 2:5)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-27-1.png" width="672" /> O número ideal de clusters são justamente os 2 grandes grupos que eu achei que possuiriam 5 grupos dentros. Agora, o que poderia estar influenciando nessa diferença entre os dois clusters? Para avaliar isso, é necessário ver onde ambos estão localizados no rio.</p>
<pre class="r"><code>plot(spa, 
  asp = 1, 
  type = &quot;n&quot;, 
  xlab = &quot;x coordinate (km)&quot;, 
  ylab = &quot;y coordinate (km)&quot;
)
lines(spa, col = &quot;grey&quot;) # colorindo o plot
text(spa[1:19,], col = &quot;blue&quot;)
text(spa[20:22,], rownames(spa[19:21,]), col = &quot;red&quot;)
text(spa[23:25,], rownames(spa[22:24,]), col = &quot;blue&quot;)
text(spa[26:30,], rownames(spa[25:29,]), col = &quot;red&quot;)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-28-1.png" width="672" /> Aqui um plot onde o vermelho representa o cluster 1, e o azul representa o cluster 2. É possível observar que desde a nascente até mais ou menos a parte média do rio, as comunidades fazem parte do cluster 2, mais abaixo no médio rio do cluster 1, brevemente do cluster 2 no médio-baixo rio, e novamente cluster 1 na foz. Por conta da “interrupção” na distribuição do clusters, penso que talvez esses grupos de similaridade estão relacionados com fatores ambientais que são distribuídos de forma menos linear no rio, como oxigênio e nitrato.</p>
</div>
<div id="métodos-de-ordenamento" class="section level2">
<h2>Métodos de ordenamento</h2>
<p>exemplo: Uma usina hidroelétrica está para ser construída no rio e o governo encomendou estudos de impacto ambiental que precisam demonstrar várias coisas. É necessário analisar tanto a comunidade de peixes como as condições físico-quimicas do rio.</p>
<p>Primeiro, fazendo uma PCA com as variáveis ambientais:</p>
<pre class="r"><code>env_pca&lt;-env[,-1][,-4]# retirando as colunas dfs e dis
princomp(env_pca)-&gt; pca_env
summary(pca_env)</code></pre>
<pre><code>## Importance of components:
##                             Comp.1       Comp.2      Comp.3       Comp.4
## Standard deviation     265.7458613 11.064942601 8.908097576 6.7050299489
## Proportion of Variance   0.9962717  0.001727202 0.001119476 0.0006342292
## Cumulative Proportion    0.9962717  0.997998899 0.999118374 0.9997526036
##                             Comp.5       Comp.6       Comp.7       Comp.8
## Standard deviation     4.010801606 9.586972e-01 6.966768e-01 2.031298e-01
## Proportion of Variance 0.000226938 1.296605e-05 6.847112e-06 5.820925e-07
## Cumulative Proportion  0.999979542 9.999925e-01 9.999994e-01 9.999999e-01
##                              Comp.9
## Standard deviation     6.693884e-02
## Proportion of Variance 6.321223e-08
## Cumulative Proportion  1.000000e+00</code></pre>
<p>Pelo summary é possível observar que a maior parte da variação está de longe em Comp. 1.</p>
<pre class="r"><code>library(tidyverse)
library(factoextra)
pca_env$scores %&gt;% 
as.tibble() %&gt;% 
mutate(setor=ifelse(Comp.1&lt;0,&quot;medio-baixo&quot;, &quot;alto&quot;))-&gt; env_set
fviz_pca_ind(pca_env,
             geom.ind = &quot;point&quot;, # show points only (nbut not &quot;text&quot;)
             col.ind = env_set$setor, # color by groups
             palette = c(&quot;#009999&quot;, &quot;#0000FF&quot;),
             addEllipses = TRUE, # Concentration ellipses
             legend.title = &quot;Groups&quot;
             )</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-30-1.png" width="672" /> É observado que o eixo horizontal explica quase toda a variação nos dados. Também existe um overlap considerável entre os dois grupos.</p>
<p>Agora, fazendo uma NMDS dos dados das espécies.</p>
<pre class="r"><code>library(vegan)
nmds&lt;-metaMDS(spe) </code></pre>
<pre><code>## Run 0 stress 0.07477809 
## Run 1 stress 0.1248198 
## Run 2 stress 0.08841669 
## Run 3 stress 0.1134129 
## Run 4 stress 0.08917038 
## Run 5 stress 0.0738367 
## ... New best solution
## ... Procrustes: rmse 0.01960989  max resid 0.09439325 
## Run 6 stress 0.1111023 
## Run 7 stress 0.08841674 
## Run 8 stress 0.0742934 
## ... Procrustes: rmse 0.01374155  max resid 0.06390472 
## Run 9 stress 0.07477827 
## Run 10 stress 0.07477823 
## Run 11 stress 0.1223636 
## Run 12 stress 0.08841673 
## Run 13 stress 0.08845295 
## Run 14 stress 0.1127535 
## Run 15 stress 0.09288416 
## Run 16 stress 0.120581 
## Run 17 stress 0.07376231 
## ... New best solution
## ... Procrustes: rmse 0.003800054  max resid 0.01466883 
## Run 18 stress 0.1127442 
## Run 19 stress 0.1104323 
## Run 20 stress 0.07477802 
## *** No convergence -- monoMDS stopping criteria:
##     20: stress ratio &gt; sratmax</code></pre>
<pre class="r"><code>nmds_dat&lt;-data.frame(nmds$points, spe)
colnames(nmds_dat) &lt;- c(&quot;MDS1&quot;,&quot;MDS2&quot;, &quot;setor&quot;)
nmds_dat %&gt;% 
  ggplot(aes(MDS1, MDS2, color=setor))+geom_point()</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-32-1.png" width="672" /> Existe uma certa semelhança na distribuição com a PCA dos dados ambientais, onde as comunidades do alto rio se concenctram na parte direita do gráfico, e as espécies do médio-baixo na parte esquerda e central. Isso signiica que provavelmente a distribuição das variaveis ambientais (que são explicados quase que somente por PC1) afeta essa distribuição matemática das comunidades.</p>
<p>Dessa forma, acredito que dá pra dividir o rio em duas partes. Utilizando o método K-Means supondo clusters:</p>
<pre class="r"><code>k2_spe&lt;-kmeans(spe, centers =2, nstart=1)
fviz_cluster(k2_spe, data = spe)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-33-1.png" width="672" /> Agora para os dados ambientais</p>
<pre class="r"><code>k2&lt;-kmeans(env, centers =2, nstart=1)
fviz_cluster(k2, data = env)</code></pre>
<p><img src="Journal_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>Com base em todas essas análises, princiapalmente no PCA e NMDS, é observado que várias espécies do alto rio também estão presente no baixo-médio rio, mas o contrário não é verdade. A hidrelética, se construida no alto rio, irá prejudicar as comunidades de lá, porém, parte da diversidade do alto rio é representa em comunidades do baixo-médio rio. Seria menos danoso construir a hidrelétrica no alto rio.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
